{% extends "Main/index.html" %}
{% load static %}
{% block content %}
<header class="page-title-bar">
    <div class="d-md-flex align-items-md-start">
      <h1 class="page-title mr-sm-auto">EDIT CUSTOMER </h1>
    </div>
  </header>
  
  <div class="card card-fluid">
    <h6 class="card-header"> Customer</h6>
    <div class="card-body">
  
      <form method="post" id="manage-estimate">
        {% csrf_token %}
        <div class="form-row">
          <input type="hidden">
  
          <div class="col-md-6 mb-3">
            <label for="fname">First Name</label>
            <input type="text" class="form-control" id="fname" name="fname" placeholder="Enter First Name" value="{{ form.fname.value }}" required>
          </div>
  
          <div class="col-md-6 mb-3">
            <label for="input02">Middle Name</label> <input type="text" class="form-control" id="mname" name="mname" placeholder="Enter Middle Name" value="{{ form.mname.value }}"
             >
          </div>
        </div>
  
        <div class="form-row">
  
          <div class="col-md-6 mb-3">
            <label for="input03">Last Name </label> <input type="text" class="form-control" id="lname" name="lname" placeholder="Enter Last Name" value="{{ form.lname.value }}"  required>
          </div>
  
  
          <div class="col-md-6 mb-3">
            <label for="input03">Phone No/WhatsApp No</label>
            <input type="text" class="form-control" id="phone" name="ph" placeholder="Enter Phone No" required pattern="^\d{10}$" title="Phone number must be exactly 10 digits" value="{{ form.ph.value }}">
          </div>
  
  
          <div class="col-md-6 mb-3">
            <label for="input04">Mail ID</label>
            <input type="email" class="form-control" id="email" name="email" value="{{ form.email.value }}" placeholder="Enter Mail ID" required  pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$" title="Please enter a valid email address">
          </div>
  
  
  
          <div class="col-md-6 mb-3">
            <label for="input04">DOB</label>
            <input type="date" class="form-control" id="dob" name="dob" value="{{ form.dob.value }}" required >
          </div>
  
  
          <div class="col-md-6 mb-3">
            <label for="input03">Occupation</label> <input type="text" class="form-control" id="occupation" name="occupation" value="{{ form.occupation.value }}" placeholder="Enter Occupation" >
          </div>
  
          <div class="col-md-6 mb-3">
            <label for="input04">Nominee</label> <input type="text" class="form-control" id="nominee" name="nam" value="{{ form.nam.value }}" placeholder="Enter Nominee Name">
          </div>
  
          <div class="col-md-6 mb-3">
            <label for="input03">Relationship</label> <input type="text" class="form-control" id="relationship" value="{{ form.relation.value }}" name="relation" placeholder="Enter Relationship" >
          </div>
  
          <div class="col-md-6 mb-3">
            <label for="input04">Present Address</label> <input type="text" class="form-control" name="raddress" value="{{ form.raddress.value }}" placeholder="Enter Present Address" >
          </div>
  
          <div class="col-md-6 mb-3">
            <label for="input03">Permanent Address</label> <input type="text" class="form-control" name="paddress" value="{{ form.paddress.value }}" placeholder="Enter Permanent Address" >
          </div>
  
          <div class="col-md-6 mb-3">
            <label for="input04">Aadhaar Number</label>
            <input type="text" class="form-control" id="dhaarNumber" name="adhar" placeholder="Enter Aadhaar Number" value="{{ form.adhar.value }}"  pattern="^\d{12}$" maxlength="12" required title="Please enter correct aadhar 12 digits">
          </div>
  
  
          <div class="col-md-6 mb-3">
            <label for="apartmentLayout">Apartment/Layout</label>
            <select id="apartmentLayout" name="p_name" class="form-control">
              {% if form.p_name.value == "Apartment" %}
              <option value="Apartment">Apartment</option>
              <option value="Layout">Layout</option>
              {% endif %}
              {% if form.p_name.value == "Layout" %}
              <option value="Layout">Layout</option>
              <option value="Apartment">Apartment</option>
              {% endif %}
            </select>
          </div>
  
  
      </form>
  
  
  
  
    </div>
    </form>
    <div class="form-actions">
      <button type="submit" class="btn btn-primary ml-auto" id="save-estimate-btn" form="manage-estimate">Submit</button>
    </div>
  </div>
  </div>
  </div>
  </div>
  </div>
  
  
  <script>
    $(document).ready(function() {
      // Define loading functions
      function start_load() {
        $('body').prepend('<div id="preloader"></div>');
      }
  
      function end_load() {
        $('#preloader').fadeOut('fast', function() {
          $(this).remove();
        });
      }
  
      // Bind form submit event
      {% comment %} $('#manage-estimate').on('submit', function(e) {
        e.preventDefault(); // Prevent default form submission
  
        start_load();
        $.ajax({
          url: 'ajax.php?action=save_customer',
          data: new FormData(this),
          cache: false,
          contentType: false,
          processData: false,
          method: 'POST',
          success: function(resp) {
            if (resp == 1) {
              toastr.success('Data successfully saved');
              setTimeout(function() {
                location.href = 'index.php?page=customer_list';
              }, 2000);
            } else {
              $('#msg').html('<div class="alert alert-danger"><i class="fa fa-exclamation-triangle"></i> An error occurred</div>');
            }
            end_load();
          },
          error: function(xhr) {
            console.error('Error:', xhr);
            toastr.error('An error occurred while processing the request.');
            end_load();
          }
        });
      }); {% endcomment %}
    });
  </script>
  
  
  
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
  {% endblock %}